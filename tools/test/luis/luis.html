<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luis - PinoyBPO Assistant</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://code.jquery.com/jquery-3.7.1.js"></script>
    <style>
        /* Base Styling */
        body {
            font-family: "Inter", sans-serif;
            min-height: 100vh;
            background-color: #f7f7f7;
        }

        /* Fixed Position Container (Icon remains bottom right) */
        #luis-container {
            position: fixed;
            bottom: 20px;
            right: 20px;
            z-index: 1050;
        }

        /* Luis Icon Button (Floating Image/Icon) */
        .luis-icon-btn {
            width: 70px;
            height: 70px;
            padding: 0;
            border-radius: 50%;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.4);
            transition: transform 0.2s, box-shadow 0.2s;
            border: 4px solid #fff;
            overflow: hidden;
            cursor: pointer;
            outline: none;
            background-color: #2c41a8; /* Primary Dark Blue */
        }
        .luis-icon-btn:hover {
            transform: scale(1.05);
            box-shadow: 0 6px 16px rgba(0, 0, 0, 0.5);
        }

        /* Popover Styling */
        .luis-popover {
            width: 380px;
            height: 500px; 
            background: white;
            border-radius: 1rem;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.3);
            display: flex; 
            flex-direction: column; 
            overflow: hidden;
            border: 1px solid #e0e0e0;
        }
        
        /* Header */
        .luis-popover-header {
            background-color: #2c41a8; /* Primary Dark Blue Header */
            color: white;
            flex-shrink: 0; 
        }

        /* Body (Chat Area) */
        .luis-popover-body {
            flex-grow: 1;
            overflow-y: scroll; 
            padding: 1rem;
            background-color: #f0f3ff; /* Very light complementary blue background */
        }

        /* ---------------------------------------------------- */
        /* Scrollbar Styling for Navigation */
        /* ---------------------------------------------------- */
        .luis-popover-body::-webkit-scrollbar {
            width: 8px; /* Width of the scrollbar */
        }
        .luis-popover-body::-webkit-scrollbar-thumb {
            /* Scrollbar handle */
            background-color: #a0a0a0; 
            border-radius: 10px;
            border: 2px solid #f0f3ff; /* Match chat background */
        }
        .luis-popover-body::-webkit-scrollbar-thumb:hover {
             background-color: #707070;
        }
        .luis-popover-body::-webkit-scrollbar-track {
             /* Scrollbar track */
            background: #f1f1f1;
        }
        /* ---------------------------------------------------- */

        /* Luis Response Bubble */
        .luis-response-container {
             display: flex;
             align-items: flex-start;
             margin-bottom: 1rem;
        }
        .luis-response-avatar {
             width: 32px;
             height: 32px;
             min-width: 32px;
             background-color: #2c41a8; /* Primary Dark Blue */
             color: white;
             border-radius: 50%;
             display: flex;
             align-items: center;
             justify-content: center;
             margin-right: 0.5rem;
             box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .luis-response {
            background-color: white;
            padding: 1rem;
            border-radius: 0.75rem;
            box-shadow: 0 1px 3px rgba(0, 0, 0, 0.05);
            border: 1px solid #d1d5db;
            max-width: 85%;
        }

        /* User Query Bubble */
        .user-query-container {
            display: flex;
            justify-content: flex-end;
            align-items: flex-end;
            margin-bottom: 1rem;
        }
        .user-query-avatar {
             width: 32px;
             height: 32px;
             min-width: 32px;
             background-color: #78909c; /* Blue Gray for user */
             color: white;
             border-radius: 50%;
             display: flex;
             align-items: center;
             justify-content: center;
             margin-left: 0.5rem;
             box-shadow: 0 1px 3px rgba(0, 0, 0, 0.1);
        }
        .user-query-content {
             display: inline-block;
             max-width: 85%;
             background-color: #78909c; /* Blue Gray Bubble */
             color: white;
             padding: 0.75rem;
             border-radius: 0.75rem 0.75rem 0 0.75rem;
             box-shadow: 0 1px 3px rgba(0, 0, 0, 0.2);
        }


        /* Input Area */
        .luis-popover-footer {
            border-top: 1px solid #e0e0e0;
            padding: 1rem;
            background-color: #ffffff;
            flex-shrink: 0; 
        }
        
        .loading-dots span {
            animation: pulse 1s infinite;
        }
        .loading-dots span:nth-child(2) {
            animation-delay: 0.2s;
        }
        .loading-dots span:nth-child(3) {
            animation-delay: 0.4s;
        }

        @keyframes pulse {
            0%, 100% { opacity: 0.5; }
            50% { opacity: 1; }
        }

        /* Styling for Quick Response Buttons */
        #quick-response-buttons {
            margin-top: 0.75rem;
            padding-top: 0.75rem;
            border-top: 1px solid #e0e0e0; /* Subtle separator line */
        }
        
        .quick-response-button {
            padding: 0.25rem 0.75rem; /* Smaller padding */
            margin-right: 0.5rem;
            margin-bottom: 0.5rem;
            border-radius: 9999px; /* Pill shape */
            font-size: 0.75rem; /* text-xs for smaller look */
            font-weight: 500;
            color: #1a2765; /* Darker Blue text */
            background-color: #e6e9f5; /* Very light blue background */
            border: 1px solid #c9d3f1; /* Light Blue border */
            cursor: pointer;
            transition: background-color 0.15s, transform 0.1s;
        }

        .quick-response-button:hover {
            background-color: #d1d8f5;
            transform: translateY(-1px);
        }
    </style>
</head>
<body>

    <div id="luis-container"> 

<button id="luis-icon-btn" class="luis-icon-btn flex items-center justify-center"> 

<div id="luis-btn-content" class="w-full h-full flex items-center justify-center"> 

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-10 h-10 text-white">
                    <path stroke-linecap="round" stroke-linejoin="round" d="M8.625 9.75a.375.375 0 11-.75 0 .375.375 0 01.75 0zm0 0H7.5m2.25 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm3.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm3.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-2.625.75L15 15m-4.755-4.245L12 18m-4.245-2.25L7.5 21m-4.625-4.375l2.25 2.25M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
                </svg>
            </div>
        </button>

        <div id="luis-popover" class="luis-popover absolute bottom-full right-0 mb-3 hidden"> 

<div class="luis-popover-header p-4 flex justify-between items-center rounded-t-xl"> 

<h2 class="text-lg font-bold">Luis - PinoyBPO Assistant</h2> 

<button id="luis-close-btn" class="text-white hover:text-gray-200"> 

<svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
                        <path stroke-linecap="round" stroke-linejoin="round" d="M6 18L18 6M6 6l12 12" />
                    </svg>
                </button>
            </div>
            
            <div id="luis-popover-body" class="luis-popover-body flex flex-col"> 

<div id="luis-initial-response" class="luis-response-container"> 

<div class="luis-response-avatar"> 

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                            <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.065A8.243 8.243 0 0010 18.25a8.236 8.236 0 006.125-2.692 1.23 1.23 0 00.41-1.065A8.236 8.236 0 0010 10.75a8.236 8.236 0 00-6.535 3.743z" />
                        </svg>
                    </div>
                    <div class="luis-response shadow-md"> 

<h3 class="font-bold text-xl text-blue-800 mb-2">Hello, I'm Luis!</h3> 

<p class="text-gray-700">
                            I am your dedicated assistant for **PinoyBPO**. I can help answer questions about BPO careers, job openings, training, and the application process.
                        </p>
                        <p class="text-sm text-gray-500 mt-2">
                            Ask me anything about starting your BPO career! For example: "What is the starting salary?"
                        </p>
                        <div id="quick-response-buttons" class="mt-2 flex flex-wrap justify-start">
                            </div>
                    </div>
                </div>
            </div>

            <div class="luis-popover-footer"> 

<div class="flex items-center space-x-2">
                    <input type="text" id="luis-input" placeholder="Ask a question..." 

class="flex-grow p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2c41a8] text-sm"> 

<button id="luis-ask-btn" class="px-3 py-3 bg-[#2c41a8] text-white rounded-lg hover:bg-[#1a2b77] transition duration-150 flex items-center justify-center" style="width: 44px; height: 44px;"> 

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-6 h-6">
                            <path d="M3.105 2.15A1 1 0 014.28 1.488l14.02 7.01a1 1 0 010 1.764l-14.02 7.01A1 1 0 013.105 17.85L17.85 10l-14.745-7.85z" />
                        </svg>
                    </button>
                </div>
                <div id="luis-status" class="text-sm text-center text-gray-500 mt-2 hidden"> 

Luis is thinking<span class="loading-dots"><span>.</span><span>.</span><span>.</span></span> 

</div>
            </div>
        </div>
    </div>

    <script type="module">
        // --- PinoyBPO .INI CONTENT FALLBACK (Quick Response Buttons) ---
        const mockupDataIni = `
[menu buttons]
View Job Openings,link,'https://www.pinoybpo.com/careers'
Apply Now,prompt,'The best way to apply is to visit our official careers page and submit your resume for review. Good luck!'
`; // Using the mockup data directly

        /**
         * Attempts to fetch luis.ini and falls back to mockupDataIni on failure.
         * @returns {Promise<string>} The INI content string.
         */
        async function loadIniContent() {
            try {
                const iniUrl = 'luis.ini';
                const response = await fetch(iniUrl);
                
                if (!response.ok) {
                    throw new Error(`Failed to fetch luis.ini: ${response.statusText}`); 
                }
                
                console.log("Successfully loaded luis.ini.");
                return await response.text();
            } catch (error) {
                console.error("Error loading luis.ini. Using mockup fallback.", error);
                return mockupDataIni;
            }
        }

        // --- INI PARSING AND RENDERING FUNCTIONS ---

        /**
         * Parses the INI content to extract quick response buttons.
         * @returns {Array<{label: string, type: 'link'|'prompt', value: string}>}
         */
        function parseIniContent(content) {
            const buttons = [];
            const lines = content.split('\n');
            let inButtonsSection = false;

            for (const line of lines) {
                const trimmedLine = line.trim();
                if (trimmedLine === '[menu buttons]') {
                    inButtonsSection = true;
                    continue;
                }
                
                if (inButtonsSection && trimmedLine.startsWith('[') && trimmedLine.endsWith(']')) {
                    break; 
                }

                if (inButtonsSection && trimmedLine) {
                    const parts = trimmedLine.split(',');
                    if (parts.length >= 3) {
                        const label = parts[0].trim();
                        const type = parts[1].trim();
                        let value = parts.slice(2).join(',').trim(); 
                        
                        if (value.startsWith("'") && value.endsWith("'")) {
                            value = value.substring(1, value.length - 1);
                        }

                        if (type === 'link' || type === 'prompt') {
                            buttons.push({ label, type, value });
                        }
                    }
                }
            }
            return buttons;
        }

        /**
         * Renders quick response buttons into the dedicated container.
         */
        function renderQuickResponseButtons(buttons) {
            const container = $('#quick-response-buttons');
            container.empty();
            if (buttons.length > 0) {
                buttons.forEach((button, index) => {
                    const btn = $(`<button 
                                        class="quick-response-button" 
                                        data-type="${button.type}" 
                                        data-value="${button.value}"
                                        data-label="${button.label}"
                                    >
                                        ${button.label}
                                    </button>`);
                    container.append(btn);
                });
            }
        }

        // --- CORE CHAT LOGIC FUNCTIONS ---

        /**
         * Function to update the chat body with the latest response
         */
        function updateLuisResponse(htmlContent, isUser=false) {
            const body = $('#luis-popover-body');
            
            if (isUser) {
                body.append(`
                    <div class="user-query-container">
                        <div class="user-query-content shadow-md">${htmlContent}</div>
                        <div class="user-query-avatar">
                            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                                <path fill-rule="evenodd" d="M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-5.5-2.5a2.5 2.5 0 11-5 0 2.5 2.5 0 015 0zM10 12a5.99 5.99 0 00-4.72 2.72.75.75 0 00.33 1.05A7.472 7.472 0 0010 16a7.472 7.472 0 004.39-1.23.75.75 0 00.33-1.05A5.99 5.99 0 0010 12z" clip-rule="evenodd" />
                            </svg>
                        </div>
                    </div>
                `);
            } else {
                body.append(`
                    <div class="luis-response-container"> 

<div class="luis-response-avatar"> 

<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" fill="currentColor" class="w-5 h-5">
                                <path d="M10 8a3 3 0 100-6 3 3 0 000 6zM3.465 14.493a1.23 1.23 0 00.41 1.065A8.243 8.243 0 0010 18.25a8.236 8.236 0 006.125-2.692 1.23 1.23 0 00.41-1.065A8.236 8.236 0 0010 10.75a8.236 8.236 0 00-6.535 3.743z" />
                            </svg>
                        </div>
                        <div class="luis-response shadow-md"> 

${htmlContent}
                        </div>
                    </div>
                `);
            }
            body.scrollTop(body[0].scrollHeight);
        }

        let isRequestInProgress = false;

        // --- Core Application Logic ---

        // 1. Local Knowledge Base (formerly data.csv) - UPDATED FOR PinoyBPO
        const localData = [
            {
                question: "What is PinoyBPO's primary mission?",
                answer: "PinoyBPO is a leading platform connecting Filipinos with rewarding careers and training opportunities in the Business Process Outsourcing (BPO) industry.",
                keywords: ["mission", "purpose", "primary goal", "what is PinoyBPO"]
            },
            {
                question: "Do you offer training for BPO beginners?",
                answer: "Yes, we partner with various training institutions to offer comprehensive courses, including basic call center skills, accent neutralization, and customer service fundamentals.",
                keywords: ["beginner", "new", "start", "entry level", "training for beginners"]
            },
            {
                question: "Where can I find job openings?",
                answer: "You can find all current job openings on our main careers page, accessible via the 'View Job Openings' quick button or the main PinoyBPO website (https://www.pinoybpo.com).",
                keywords: ["job", "openings", "vacancies", "careers", "hiring"]
            },
            {
                question: "What is the typical starting salary in BPO?",
                answer: "Starting salaries for BPO positions in the Philippines typically range from PHP 15,000 to PHP 25,000 per month, depending on the role, company, and location.",
                keywords: ["salary", "pay", "compensation", "starting salary"]
            }
        ];

        /**
         * Formats the localData array into a string representation for the LLM prompt.
         * Format: [question, keyword|keyword, answer]
         */
        function formatLocalDataForPrompt() {
            let formattedData = "LOCAL KNOWLEDGE BASE (DATA.CSV):\n";
            localData.forEach(item => {
                const keywords = item.keywords.join('|');
                const answer = item.answer.replace(/\s+/g, ' ').trim(); 
                formattedData += `[${item.question}, ${keywords}, ${answer}]\n`;
            });
            return formattedData.trim();
        }


        // Function to search the local, embedded dataset (Fast Path)
        function searchLocalData(query) {
            const lowerQuery = query.toLowerCase();
            for (const item of localData) {
                if (lowerQuery.includes(item.question.toLowerCase()) || 
                    item.keywords.some(keyword => lowerQuery.includes(keyword))) {
                    return item.answer;
                }
            }
            return null;
        }

        /**
         * Function to handle the LLM API call (with Google Search grounding for external PinoyBPO content).
         * Note: API Key must be populated for this to work.
         */
        async function geminiApiCall(userQuery, attempts = 0) {
            const maxRetries = 3;
            // Updated System Prompt to account for the injected 'LOCAL KNOWLEDGE BASE' and PinoyBPO
            const systemPrompt = "You are Luis, an expert assistant for PinoyBPO. Your goal is to answer questions using both a provided LOCAL KNOWLEDGE BASE (DATA.CSV) and Google Search grounding. 1. If the user's prompt includes a 'LOCAL KNOWLEDGE BASE', prioritize finding the answer there first. 2. If the LOCAL KNOWLEDGE BASE is insufficient or not present, you MUST use Google Search to find information specifically on the PinoyBPO website (https://www.pinoybpo.com) or related external sources. Keep your response professional, friendly, and concise. Only answer questions related to PinoyBPO or the BPO/call center industry in the Philippines.";
            const apiKey = "" 
            const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-05-20:generateContent?key=${apiKey}`;

            const payload = {
                contents: [{ parts: [{ text: userQuery }] }],
                tools: [{ "google_search": {} }],
                systemInstruction: {
                    parts: [{ text: systemPrompt }]
                },
            };

            try {
                const response = await fetch(apiUrl, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify(payload)
                });

                if (!response.ok) {
                    if (response.status === 429 && attempts < maxRetries) {
                        const delay = Math.pow(2, attempts) * 1000;
                        await new Promise(resolve => setTimeout(resolve, delay));
                        return geminiApiCall(userQuery, attempts + 1);
                    }
                    throw new Error(`API request failed with status: ${response.status}`);
                }

                const result = await response.json();
                const candidate = result.candidates?.[0];

                if (candidate && candidate.content?.parts?.[0]?.text) {
                    let text = candidate.content.parts[0].text;
                    let sources = [];
                    const groundingMetadata = candidate.groundingMetadata;

                    if (groundingMetadata && groundingMetadata.groundingAttributions) {
                        sources = groundingMetadata.groundingAttributions
                            .map(attribution => ({
                                uri: attribution.web?.uri,
                                title: attribution.web?.title,
                            }))
                            .filter(source => source.uri && source.title); 
                    }
                    
                    let sourceHtml = '';
                    if (sources.length > 0) {
                        const uniqueSources = Array.from(new Set(sources.map(s => s.title)));
                        sourceHtml = `
                            <div class="mt-3 pt-3 border-t border-gray-100 text-xs text-gray-500">
                                <span class="font-semibold text-gray-600">Sources:</span> 
                                ${uniqueSources.join(', ')}
                            </div>`;
                    }

                    updateLuisResponse(`
                        <h3 class="font-bold text-lg text-blue-800 mb-2">Luis's Response:</h3> 

<p class="text-gray-700">${text}</p>
                        ${sourceHtml}
                    `);

                } else {
                     updateLuisResponse(`
                        <h3 class="font-bold text-lg text-blue-600 mb-2">Error:</h3> 

<p class="text-gray-700">I received an empty response. Please try phrasing your question differently.</p>
                    `);
                }

            } catch (error) {
                console.error("Gemini API Error:", error);
                 updateLuisResponse(`
                    <h3 class="font-bold text-lg text-blue-600 mb-2">Network Error:</h3> 

<p class="text-gray-700">I encountered an issue connecting to the knowledge base. Please check your connection or try again later.</p>
                `);
            }
        }


        /**
         * Main function to answer the user's question (from input box).
         */
        async function answerQuestion(query) {
            query = query.trim();
            if (!query || isRequestInProgress) return;

            isRequestInProgress = true;
            $('#luis-input').prop('disabled', true).val('');
            $('#luis-ask-btn').prop('disabled', true).addClass('opacity-50');
            $('#luis-status').removeClass('hidden');

            // 1. Display user query
            updateLuisResponse(query, true);

            // 2. Check Local Knowledge Base (data.csv equivalent)
            const localAnswer = searchLocalData(query);
            
            if (localAnswer) {
                updateLuisResponse(`
                    <h3 class="font-bold text-lg text-blue-800 mb-2">Luis's Local Response:</h3> 

<p class="text-gray-700">${localAnswer}</p>
                    <p class="text-xs text-gray-500 mt-2">This answer was retrieved from Luis's internal knowledge base (fast lookup).</p> 

`);
            } else {
                // 3. Call LLM API with Local Data as context
                
                const dataPrompt = formatLocalDataForPrompt();
                const fullPrompt = `User Query: "${query}"\n\nIf the User Query can be answered by the data provided below (LOCAL KNOWLEDGE BASE), use that answer. Otherwise, proceed with search.\n\n${dataPrompt}`;
                
                await geminiApiCall(fullPrompt);
            }

            // 4. Reset state
            isRequestInProgress = false;
            $('#luis-input').prop('disabled', false).focus();
            $('#luis-ask-btn').prop('disabled', false).removeClass('opacity-50');
            $('#luis-status').addClass('hidden');
        }

        /**
         * Function to handle a prompt button click directly, displaying its value as the response.
         */
        async function handlePromptButton(label, value) {
            if (isRequestInProgress) return;

            isRequestInProgress = true;
            $('#luis-input').prop('disabled', true);
            $('#luis-ask-btn').prop('disabled', true).addClass('opacity-50');
            $('#luis-status').removeClass('hidden');

            // 1. Show the button's label as the *intent* of the user
            updateLuisResponse(`**User selected Quick Response:** "${label}"`, true);
            
            // 2. Display the prompt value directly as Luis's response.
            updateLuisResponse(`
                <h3 class="font-bold text-lg text-blue-800 mb-2">Luis's Quick Reply:</h3> 

<p class="text-gray-700">${value}</p>
            `);

            // 3. Reset state
            isRequestInProgress = false;
            $('#luis-input').prop('disabled', false).focus();
            $('#luis-ask-btn').prop('disabled', false).removeClass('opacity-50');
            $('#luis-status').addClass('hidden');
        }


        // --- Event Handlers and Initialization ---

        $(document).ready(async function() {
            
            // --- Luis Image Loading Logic (UPDATED FILENAME AND ID) ---
            const luisBtnContent = $('#luis-btn-content');
            const luisSvg = luisBtnContent.html();

            // Function to load the image or fall back to SVG
            const loadLuisImage = () => {
                const img = new Image();
                img.src = 'luis.jpg';
                img.alt = 'Luis Assistant Avatar';
                img.className = 'w-full h-full object-cover';
                
                img.onload = function() {
                    luisBtnContent.empty().append(img);
                };

                img.onerror = function() {
                    luisBtnContent.html(luisSvg); 
                };
            };

            loadLuisImage();
            
            // --- Quick Response Button Rendering ---
            const iniContent = await loadIniContent(); 
            const quickResponseButtons = parseIniContent(iniContent);
            renderQuickResponseButtons(quickResponseButtons);


            // --- Popover Toggle and Close (ID changed) ---
            
            $('#luis-icon-btn, #luis-close-btn').on('click', function(e) {
                e.stopPropagation(); 
                $('#luis-popover').slideToggle(200, function() {
                    if ($(this).is(':visible')) {
                        $(this).css('display', 'flex');
                    }
                });
            });

            // Close popover when clicking outside the container
            $(document).on('click', function(e) {
                const container = $('#luis-container');
                const popover = $('#luis-popover');
                const iconBtn = $('#luis-icon-btn');
                
                if (popover.is(':visible') && !container.is(e.target) && container.has(e.target).length === 0 && !iconBtn.is(e.target) && iconBtn.has(e.target).length === 0) {
                    popover.slideUp(200);
                }
            });

            // Prevent clicks inside the popover from closing it
            $('#luis-popover').on('click', function(e) {
                e.stopPropagation();
            });


            // --- Input and Ask Button Handlers ---
            
            function handleAsk() {
                const query = $('#luis-input').val();
                if (query.trim()) {
                    answerQuestion(query);
                }
            }
            
            $('#luis-ask-btn').on('click', handleAsk);

            $('#luis-input').on('keypress', function(e) {
                if (e.which === 13) {
                    e.preventDefault();
                    handleAsk();
                }
            });
            
            // --- INI Button Logic ---
            $('#quick-response-buttons').on('click', '.quick-response-button', function() {
                const type = $(this).data('type');
                const value = $(this).data('value');
                const label = $(this).data('label'); 

                if (type === 'link') {
                    window.open(value, '_blank'); 
                } else if (type === 'prompt') {
                    handlePromptButton(label, value);
                }
            });
            // --- END INI Button Logic ---


        });
    </script>

</body>
</html>
